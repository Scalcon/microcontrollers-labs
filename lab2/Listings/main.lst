


ARM Macro Assembler    Page 1 


    1 00000000         ; main.s
    2 00000000         ; Desenvolvido para a placa EK-TM4C1294XL
    3 00000000         ; Prof. Guilherme Peron
    4 00000000         ; Ver 1 19/03/2018
    5 00000000         ; Ver 2 26/08/2018
    6 00000000         ; Este programa deve esperar o usu?rio pressionar uma ch
                       ave.
    7 00000000         ; Caso o usu?rio pressione uma chave, um LED deve piscar
                        a cada 1 segundo.
    8 00000000         
    9 00000000         ; ------------------------------------------------------
                       -------------------------
   10 00000000                 THUMB                        ; Instru??es do tip
                                                            o Thumb-2
   11 00000000         ; ------------------------------------------------------
                       -------------------------
   12 00000000         
   13 00000000         ; Declara??es EQU - Defines
   14 00000000         ;<NOME>         EQU <VALOR>
   15 00000000         ; ========================
   16 00000000         ; Defini??es de Valores
   17 00000000 00000100 
                       INVALID_DIGIT
                               EQU              256         ; Representa um d?g
                                                            ito inv?lido do tec
                                                            lado matricial
   18 00000000 FFFFFFFF 
                       INVALID_PW_CHAR
                               EQU              -1          ; Representa um car
                                                            actere impossível d
                                                            e estar na senha
   19 00000000         
   20 00000000 00000000 
                       INICIO  EQU              0
   21 00000000 00000001 
                       CONFIG_SENHA
                               EQU              1
   22 00000000 00000002 
                       COFRE_FECHANDO
                               EQU              2
   23 00000000 00000003 
                       COFRE_FECHADO
                               EQU              3
   24 00000000 00000004 
                       COFRE_ABRINDO
                               EQU              4
   25 00000000 00000005 
                       COFRE_TRAVADO
                               EQU              5
   26 00000000 00000006 
                       DESTRAVA_COFRE
                               EQU              6
   27 00000000 00000007 
                       CONFIG_SENHA_MESTRA
                               EQU              7
   28 00000000         
   29 00000000         
   30 00000000         
   31 00000000         ; ------------------------------------------------------



ARM Macro Assembler    Page 2 


                       -------------------------
   32 00000000         ; ?rea de Dados - Declara??es de vari?veis
   33 00000000                 AREA             DATA, ALIGN=2
   34 00000000         ; Se alguma vari?vel for chamada em outro arquivo
   35 00000000         ;EXPORT  <var> [DATA,SIZE=<tam>]   ; Permite chamar a va
                       ri?vel <var> a 
   36 00000000         ; partir de outro arquivo
   37 00000000         ;<var> SPACE <tam>                        ; Declara uma 
                       vari?vel de nome <var>
   38 00000000         ; de <tam> bytes a partir da primeira 
   39 00000000         ; posi??o da RAM  
   40 00000000 00 00 00 
              00 00 00 
              00 00    PASSWORDS
                               SPACE            8           ; 4 bytes para a se
                                                            nha do usuário e 4 
                                                            bytes para a senha 
                                                            mestra
   41 00000008         ; ------------------------------------------------------
                       -------------------------
   42 00000008         ; ?rea de C?digo - Tudo abaixo da diretiva a seguir ser?
                        armazenado na mem?ria de 
   43 00000008         ;                  c?digo
   44 00000008                 AREA             |.text|, CODE, READONLY, ALIGN=
2
   45 00000000         
   46 00000000         ; Se alguma fun??o do arquivo for chamada em outro arqui
                       vo 
   47 00000000                 EXPORT           Start       ; Permite chamar a 
                                                            fun??o Start a part
                                                            ir de 
   48 00000000         ; outro arquivo. No caso startup.s
   49 00000000                 EXPORT           ModificaSenhaMestra
   50 00000000                 EXPORT           DestravaCofre
   51 00000000                 EXPORT           Pisca_Transistor_PP5
   52 00000000         
   53 00000000         ; Se chamar alguma fun??o externa 
   54 00000000         ;IMPORT <func>              ; Permite chamar dentro dest
                       e arquivo uma 
   55 00000000         ; fun??o <func>
   56 00000000                 IMPORT           PLL_Init
   57 00000000                 IMPORT           SysTick_Init
   58 00000000                 IMPORT           SysTick_Wait1ms
   59 00000000         
   60 00000000                 IMPORT           GPIO_Init
   61 00000000                 IMPORT           PortA_Output
   62 00000000                 IMPORT           PortP_Output
   63 00000000                 IMPORT           PortQ_Output
   64 00000000         
   65 00000000                 IMPORT           LCD_Init
   66 00000000                 IMPORT           LCD_Line2
   67 00000000                 IMPORT           LCD_Reset
   68 00000000                 IMPORT           LCD_PrintString
   69 00000000         
   70 00000000                 IMPORT           MapMatrixKeyboard
   71 00000000                 IMPORT           LED_Output
   72 00000000         
   73 00000000         ;?Cofre aberto, digite nova senha para fechar o cofre?.
   74 00000000 38 3D 3D 



ARM Macro Assembler    Page 3 


              3D 3D 3D 
              3D 44 20 
              20 20 20 
              00       cofre_aberto
                               DCB              "8======D    ", 0
   75 0000000D 43 6F 66 
              72 65 20 
              61 62 72 
              69 6E 64 
              6F 20 20 
              20 00    cofre_abrindo
                               DCB              "Cofre abrindo   ", 0
   76 0000001E 44 69 67 
              69 74 65 
              20 61 20 
              73 65 6E 
              68 61 20 
              20 00    digite_senha
                               DCB              "Digite a senha  ", 0
   77 0000002F 20 20 20 
              20 20 20 
              20 20 20 
              20 20 20 
              20 20 20 
              20 00    string_vazia
                               DCB              "                ", 0
   78 00000040 43 6F 66 
              72 65 20 
              66 65 63 
              68 61 6E 
              64 6F 20 
              20 00    cofre_fechando
                               DCB              "Cofre fechando  ", 0
   79 00000051 43 6F 66 
              72 65 20 
              66 65 63 
              68 61 64 
              6F 20 20 
              20 00    cofre_fechado
                               DCB              "Cofre fechado   ", 0
   80 00000062 4E 6F 76 
              61 20 6D 
              65 73 74 
              72 61 20 
              20 20 20 
              20 00    reset_senha_mestra
                               DCB              "Nova mestra     ", 0
   81 00000073 4D 65 73 
              74 72 61 
              20 61 6C 
              74 65 72 
              61 64 61 
              20 00    senha_mestra_alterada
                               DCB              "Mestra alterada ", 0
   82 00000084 43 6F 66 
              72 65 20 
              74 72 61 
              76 61 64 
              6F 20 20 



ARM Macro Assembler    Page 4 


              20 00    cofre_travado
                               DCB              "Cofre travado   ", 0
   83 00000095 44 69 67 
              69 74 65 
              20 6D 65 
              73 74 72 
              61 20 20 
              20 00    digite_senha_mestra
                               DCB              "Digite mestra   ", 0
   84 000000A6         
   85 000000A6         ; ------------------------------------------------------
                       -------------------------
   86 000000A6         ; Fun??o main()
   87 000000A6         Start
   88 000000A6 F7FF FFFE       BL               PLL_Init    ; Chama a subrotina
                                                             para alterar o clo
                                                            ck do microcontrola
                                                            dor para 80MHz
   89 000000AA F7FF FFFE       BL               SysTick_Init ; Chama a subrotin
                                                            a para inicializar 
                                                            o SysTick
   90 000000AE F7FF FFFE       BL               GPIO_Init   ; Chama a subrotina
                                                             que inicializa os 
                                                            GPIO
   91 000000B2         
   92 000000B2         
   93 000000B2 F7FF FFFE       BL               LCD_Init    ; Chama a subrotina
                                                             que inicializa o L
                                                            CD
   94 000000B6 F44F 7680       MOV              R6, #INVALID_DIGIT ; R6 usado p
                                                            ara guardar o d?git
                                                            o lido do teclado
   95 000000BA F04F 0700       MOV              R7, #0      ; R7 usado para con
                                                            tar quantos d?gitos
                                                             o usu?rio digitou
   96 000000BE F04F 0500       MOV              R5, #INICIO ; Seta o estado ini
                                                            cial para cofre abe
                                                            rto
   97 000000C2 F04F 0900       MOV              R9, #0      ; Contador para com
                                                            parar a senha inser
                                                            ida com a senha na 
                                                            memória
   98 000000C6 F04F 0A00       MOV              R10, #0     ; Contador para con
                                                            tar a quantidade de
                                                             acertos da senha
   99 000000CA F8DF 8274       LDR              R8, =PASSWORDS ; R8 usado para 
                                                            apontar a posição d
                                                            a senha salva na me
                                                            mória
  100 000000CE F04F 0C00       MOV              R12, #0     ; Contador da quant
                                                            idade de erros da s
                                                            enha
  101 000000D2         
  102 000000D2 F04F 0B01       MOV              R11, #1
  103 000000D6 F888 B006       STRB             R11, [R8, #6]
  104 000000DA F04F 0B02       MOV              R11, #2
  105 000000DE F888 B007       STRB             R11, [R8, #7]
  106 000000E2 F04F 0B03       MOV              R11, #3
  107 000000E6 F888 B008       STRB             R11, [R8, #8]



ARM Macro Assembler    Page 5 


  108 000000EA F04F 0B04       MOV              R11, #4
  109 000000EE F888 B009       STRB             R11, [R8, #9]
  110 000000F2         
  111 000000F2         MainLoop
  112 000000F2 2D00            CMP              R5, #INICIO
  113 000000F4 D00D            BEQ              EstadoInicial
  114 000000F6 2D01            CMP              R5, #CONFIG_SENHA
  115 000000F8 D025            BEQ              InserirSenha
  116 000000FA 2D02            CMP              R5, #COFRE_FECHANDO
  117 000000FC D032            BEQ              CofreFechando
  118 000000FE 2D03            CMP              R5, #COFRE_FECHADO
  119 00000100 D044            BEQ              CofreFechado
  120 00000102 2D04            CMP              R5, #COFRE_ABRINDO
  121 00000104 D054            BEQ              CofreAbrindo
  122 00000106 2D05            CMP              R5, #COFRE_TRAVADO
  123 00000108 D04A            BEQ              CofreTravado
  124 0000010A 2D06            CMP              R5, #DESTRAVA_COFRE
  125 0000010C D0FE            BEQ              DestravaCofre
  126 0000010E 2D07            CMP              R5, #CONFIG_SENHA_MESTRA
  127 00000110         ;BEQ ModificaSenhaMestra
  128 00000110         
  129 00000110 E7EF            B                MainLoop
  130 00000112         
  131 00000112         EstadoInicial
  132 00000112 F7FF FFFE       BL               LCD_Reset
  133 00000116 4C8B            LDR              R4, =cofre_aberto ;R4 guarda as
                                                             mensagens pra most
                                                            rar no display
  134 00000118 F7FF FFFE       BL               LCD_PrintString 
                                                            ; imprime mensagem
  135 0000011C F241 3088       MOV              R0, #5000   ;seta o tempo que v
                                                            ai ficar a mensagem
                                                            
  136 00000120 F7FF FFFE       BL               SysTick_Wait1ms ;wait
  137 00000124 E7FF            B                SolicitaSenha
  138 00000126         
  139 00000126         SolicitaSenha
  140 00000126 F04F 0700       MOV              R7, #0
  141 0000012A F7FF FFFE       BL               LCD_Reset   ;limpa o display
  142 0000012E 4C86            LDR              R4,=digite_senha ; muda a strin
                                                            g que vai pro displ
                                                            ay
  143 00000130 F7FF FFFE       BL               LCD_PrintString ;imprime nova s
                                                            tring
  144 00000134 F241 3088       MOV              R0, #5000   ; seta o tempo
  145 00000138 F7FF FFFE       BL               SysTick_Wait1ms
  146 0000013C F7FF FFFE       BL               LCD_Reset   ;limpa o display
  147 00000140 F04F 0501       MOV              R5,#CONFIG_SENHA ; muda o estad
                                                            o do cofre
  148 00000144         
  149 00000144 E7D5            B                MainLoop
  150 00000146         
  151 00000146         InserirSenha
  152 00000146 F7FF FFFE       BL               MapMatrixKeyboard
  153 0000014A F5B6 7F80       CMP              R6, #INVALID_DIGIT
  154 0000014E BF18            IT               NE
  155 00000150 F808 6007       STRBNE           R6, [R8, R7] ; guarda a senha
  156 00000154 F44F 7680       MOV              R6, #INVALID_DIGIT ; Depois de 
                                                            contabilizado, inva



ARM Macro Assembler    Page 6 


                                                            lida R6 para evitar
                                                             erros
  157 00000158         
  158 00000158 2F04            CMP              R7, #4      ; Verifica se 4 d?g
                                                            itos foram inserido
                                                            s
  159 0000015A DBF4            BLT              InserirSenha ; Se não, volta pa
                                                            ra o inicio
  160 0000015C D8E3            BHI              SolicitaSenha
  161 0000015E         
  162 0000015E 2D02            CMP              R5, #COFRE_FECHANDO ; Verifica 
                                                            se o estado do cofr
                                                            e ? fechando 
  163 00000160 D1F1            BNE              InserirSenha ; Se ainda n?o for
                                                            , volta para config
                                                            urar a senha
  164 00000162 E7C6            B                MainLoop
  165 00000164         
  166 00000164         CofreFechando
  167 00000164 F7FF FFFE       BL               LCD_Reset   ;limpa o display
  168 00000168 F44F 707A       MOV              R0, #1000   ; seta o tempo  de 
                                                            1s
  169 0000016C F7FF FFFE       BL               SysTick_Wait1ms
  170 00000170 4C76            LDR              R4,=cofre_fechando ; muda a str
                                                            ing que vai pro dis
                                                            play
  171 00000172 F7FF FFFE       BL               LCD_PrintString ;imprime nova s
                                                            tring
  172 00000176 F241 3088       MOV              R0, #5000   ; seta o tempo de 5
                                                            s
  173 0000017A F7FF FFFE       BL               SysTick_Wait1ms
  174 0000017E F7FF FFFE       BL               LCD_Reset
  175 00000182 F04F 0503       MOV              R5, #COFRE_FECHADO
  176 00000186 F04F 0700       MOV              R7, #0      ; R7 usado para con
                                                            tar quantos d?gitos
                                                             o usu?rio digitou
  177 0000018A         
  178 0000018A E7B2            B                MainLoop
  179 0000018C         
  180 0000018C         CofreFechado
  181 0000018C F7FF FFFE       BL               LCD_Reset
  182 00000190 4C6F            LDR              R4,=cofre_fechado ; muda a stri
                                                            ng que vai pro disp
                                                            lay
  183 00000192 F7FF FFFE       BL               LCD_PrintString ;imprime nova s
                                                            tring
  184 00000196 F241 3088       MOV              R0, #5000   ; seta o tempo de 5
                                                            s
  185 0000019A F7FF FFFE       BL               SysTick_Wait1ms
  186 0000019E         
  187 0000019E E050            B                PedeSenhaFechado
  188 000001A0         
  189 000001A0         CofreTravado
  190 000001A0 F7FF FFFE       BL               LCD_Reset
  191 000001A4 4C6B            LDR              R4,=cofre_travado ; muda a stri
                                                            ng que vai pro disp
                                                            lay
  192 000001A6 F7FF FFFE       BL               LCD_PrintString ;imprime nova s
                                                            tring



ARM Macro Assembler    Page 7 


  193 000001AA F7FF FFFE       BL               LED_Output
  194 000001AE         
  195 000001AE E7A0            B                MainLoop
  196 000001B0         
  197 000001B0         CofreAbrindo
  198 000001B0 F7FF FFFE       BL               LCD_Reset   ;limpa o display
  199 000001B4 F44F 707A       MOV              R0, #1000   ; seta o tempo  de 
                                                            1s
  200 000001B8 F7FF FFFE       BL               SysTick_Wait1ms
  201 000001BC 4C66            LDR              R4,=cofre_abrindo ; muda a stri
                                                            ng que vai pro disp
                                                            lay
  202 000001BE F7FF FFFE       BL               LCD_PrintString ;imprime nova s
                                                            tring
  203 000001C2 F241 3088       MOV              R0, #5000   ; seta o tempo de 5
                                                            s
  204 000001C6 F7FF FFFE       BL               SysTick_Wait1ms
  205 000001CA F7FF FFFE       BL               LCD_Reset
  206 000001CE F04F 0500       MOV              R5, #INICIO
  207 000001D2 F04F 0700       MOV              R7, #0      ; Zera R7
  208 000001D6 F04F 0A00       MOV              R10, #0     ; Zera R10
  209 000001DA F04F 0C00       MOV              R12, #0
  210 000001DE         
  211 000001DE E788            B                MainLoop
  212 000001E0         
  213 000001E0         DestravaCofre
  214 000001E0 F7FF FFFE       BL               LCD_Line2   ; Coloca o cursor n
                                                            o começo da segunda
                                                             linha
  215 000001E4         
  216 000001E4 4C5D            LDR              R4, =digite_senha_mestra ; Impr
                                                            ime a mensagem de d
                                                            igitar a senha
  217 000001E6 F7FF FFFE       BL               LCD_PrintString
  218 000001EA         
  219 000001EA F44F 707A       MOV              R0, #1000   ; seta o tempo de 0
                                                            ,5s
  220 000001EE F7FF FFFE       BL               SysTick_Wait1ms
  221 000001F2         
  222 000001F2 F7FF FFFE       BL               LCD_Line2
  223 000001F6 4C5A            LDR              R4, =string_vazia ; Imprime uma
                                                             string vazia na se
                                                            gunda linha
  224 000001F8 F7FF FFFE       BL               LCD_PrintString
  225 000001FC         
  226 000001FC F7FF FFFE       BL               LCD_Line2   ; Depois do cursor 
                                                            ser deslocado para 
                                                            o fim, posiciona de
                                                             volta no começo
  227 00000200         
  228 00000200 F44F 7680       MOV              R6, #INVALID_DIGIT ; Nenhum díg
                                                            ito foi lido. Coloc
                                                            a R6 em estado invá
                                                            lido (reset)
  229 00000204         
  230 00000204 F04F 0705       MOV              R7, #5
  231 00000208 F04F 0A00       MOV              R10, #0
  232 0000020C         
  233 0000020C E04D            B                ConferirSenhaMestra



ARM Macro Assembler    Page 8 


  234 0000020E         
  235 0000020E         ModificaSenhaMestra
  236 0000020E         
  237 0000020E B500            PUSH             {LR}
  238 00000210 F7FF FFFE       BL               LCD_Reset
  239 00000214 F85D EB04       POP              {LR}
  240 00000218 4C52            LDR              R4,=reset_senha_mestra ; muda a
                                                             string que vai pro
                                                             display
  241 0000021A B500            PUSH             {LR}
  242 0000021C F7FF FFFE       BL               LCD_PrintString ;imprime nova s
                                                            tring
  243 00000220 F85D EB04       POP              {LR}
  244 00000224 F44F 60FA       MOV              R0, #2000   ; seta o tempo de 2
                                                            s
  245 00000228 B500            PUSH             {LR}
  246 0000022A F7FF FFFE       BL               SysTick_Wait1ms
  247 0000022E F85D EB04       POP              {LR}
  248 00000232         
  249 00000232 B500            PUSH             {LR}
  250 00000234 F7FF FFFE       BL               LCD_Line2
  251 00000238 F85D EB04       POP              {LR}
  252 0000023C F04F 0705       MOV              R7, #5
  253 00000240 E047            B                DigitaSenhaMestra
  254 00000242         
  255 00000242         PedeSenhaFechado
  256 00000242 F7FF FFFE       BL               LCD_Line2   ; Coloca o cursor n
                                                            o começo da segunda
                                                             linha
  257 00000246         
  258 00000246 4C40            LDR              R4, =digite_senha ; Imprime a m
                                                            ensagem de digitar 
                                                            a senha
  259 00000248 F7FF FFFE       BL               LCD_PrintString
  260 0000024C         
  261 0000024C F44F 707A       MOV              R0, #1000   ; seta o tempo de 0
                                                            ,5s
  262 00000250 F7FF FFFE       BL               SysTick_Wait1ms
  263 00000254         
  264 00000254 F7FF FFFE       BL               LCD_Line2
  265 00000258         
  266 00000258 4C41            LDR              R4, =string_vazia ; Imprime uma
                                                             string vazia na se
                                                            gunda linha
  267 0000025A F7FF FFFE       BL               LCD_PrintString
  268 0000025E         
  269 0000025E F7FF FFFE       BL               LCD_Line2   ; Depois do cursor 
                                                            ser deslocado para 
                                                            o fim, posiciona de
                                                             volta no começo
  270 00000262         
  271 00000262 F04F 0700       MOV              R7, #0      ; Zera R7
  272 00000266 F04F 0A00       MOV              R10, #0     ; Zera R10
  273 0000026A         
  274 0000026A F44F 7680       MOV              R6, #INVALID_DIGIT ; Nenhum díg
                                                            ito foi lido. Coloc
                                                            a R6 em estado invá
                                                            lido (reset)
  275 0000026E         



ARM Macro Assembler    Page 9 


  276 0000026E E7FF            B                ConferirSenha
  277 00000270         
  278 00000270         ConferirSenha
  279 00000270 F7FF FFFE       BL               MapMatrixKeyboard ; Lê o dígito
                                                             pressionado no tec
                                                            lado e guarda em R6
                                                            
  280 00000274         
  281 00000274 F818 9007       LDRB             R9, [R8, R7] ; coloca em R9 os 
                                                            digitos a senha
  282 00000278 454E            CMP              R6, R9
  283 0000027A BF08 F10A 
              0A01             ADDEQ            R10, R10, #1 ; incrementar cont
                                                            ador de acertos se 
                                                            o digito inserido f
                                                            or igual o da memór
                                                            ia
  284 00000280         
  285 00000280 F44F 7680       MOV              R6, #INVALID_DIGIT ; Depois de 
                                                            contabilizado, inva
                                                            lida R6 para evitar
                                                             erros
  286 00000284 F04F 39FF       MOV              R9, #INVALID_PW_CHAR
  287 00000288         
  288 00000288 2F04            CMP              R7, #4      ; Verifica se 4 d?g
                                                            itos foram inserido
                                                            s
  289 0000028A DBF1            BLT              ConferirSenha ; Se não, volta p
                                                            ara o inicio
  290 0000028C         
  291 0000028C F1BA 0F04       CMP              R10, #4
  292 00000290 BF08            IT               EQ
  293 00000292 2504            MOVEQ            R5, #COFRE_ABRINDO
  294 00000294 D08C            BEQ              CofreAbrindo
  295 00000296         
  296 00000296 F04F 0700       MOV              R7, #0
  297 0000029A F10C 0C01       ADD              R12, R12, #1
  298 0000029E F1BC 0F03       CMP              R12, #3
  299 000002A2 DBCE            BLT              PedeSenhaFechado
  300 000002A4 BF08            IT               EQ
  301 000002A6 2505            MOVEQ            R5, #COFRE_TRAVADO
  302 000002A8         
  303 000002A8 E723            B                MainLoop
  304 000002AA         
  305 000002AA         ConferirSenhaMestra
  306 000002AA F7FF FFFE       BL               MapMatrixKeyboard ; Lê o dígito
                                                             pressionado no tec
                                                            lado e guarda em R6
                                                            
  307 000002AE         
  308 000002AE F818 9007       LDRB             R9, [R8, R7] ; coloca em R9 os 
                                                            digitos a senha
  309 000002B2 454E            CMP              R6, R9
  310 000002B4 BF08 F10A 
              0A01             ADDEQ            R10, R10, #1 ; incrementar cont
                                                            ador de acertos se 
                                                            o digito inserido f
                                                            or igual o da memór
                                                            ia



ARM Macro Assembler    Page 10 


  311 000002BA         
  312 000002BA F44F 7680       MOV              R6, #INVALID_DIGIT ; Depois de 
                                                            contabilizado, inva
                                                            lida R6 para evitar
                                                             erros
  313 000002BE F04F 39FF       MOV              R9, #INVALID_PW_CHAR
  314 000002C2         
  315 000002C2 2F09            CMP              R7, #9      ; Verifica se 4 d?g
                                                            itos foram inserido
                                                            s
  316 000002C4 DBF1            BLT              ConferirSenhaMestra ; Se não, v
                                                            olta para o inicio
  317 000002C6         
  318 000002C6 F1BA 0F04       CMP              R10, #4
  319 000002CA BF0C            ITE              EQ
  320 000002CC 2504            MOVEQ            R5, #COFRE_ABRINDO
  321 000002CE 2506            MOVNE            R5, #DESTRAVA_COFRE
  322 000002D0 E70F            B                MainLoop
  323 000002D2         
  324 000002D2         DigitaSenhaMestra
  325 000002D2 B500            PUSH             {LR}
  326 000002D4 F7FF FFFE       BL               MapMatrixKeyboard
  327 000002D8 F85D EB04       POP              {LR}
  328 000002DC F5B6 7F80       CMP              R6, #INVALID_DIGIT
  329 000002E0 BF18            IT               NE
  330 000002E2 F808 6007       STRBNE           R6, [R8, R7] ; guarda a senha
  331 000002E6 F44F 7680       MOV              R6, #INVALID_DIGIT ; Depois de 
                                                            contabilizado, inva
                                                            lida R6 para evitar
                                                             erros
  332 000002EA         
  333 000002EA 2F09            CMP              R7, #9      ; Verifica se 4 d?g
                                                            itos foram inserido
                                                            s
  334 000002EC DBF1            BLT              DigitaSenhaMestra ; Se não, vol
                                                            ta para o inicio 
  335 000002EE D8FE            BHI              ModificaSenhaMestra
  336 000002F0 D0FF            BEQ              SenhaMestraAlterada
  337 000002F2         
  338 000002F2         SenhaMestraAlterada
  339 000002F2 B500            PUSH             {LR}
  340 000002F4 F7FF FFFE       BL               LCD_Reset
  341 000002F8 F85D EB04       POP              {LR}
  342 000002FC 4C1A            LDR              R4,=senha_mestra_alterada ; mud
                                                            a a string que vai 
                                                            pro display
  343 000002FE B500            PUSH             {LR}
  344 00000300 F7FF FFFE       BL               LCD_PrintString ;imprime nova s
                                                            tring
  345 00000304 F85D EB04       POP              {LR}
  346 00000308 F44F 60FA       MOV              R0, #2000   ; seta o tempo de 2
                                                            s
  347 0000030C B500            PUSH             {LR}
  348 0000030E F7FF FFFE       BL               SysTick_Wait1ms
  349 00000312 F85D EB04       POP              {LR}
  350 00000316 4770            BX               LR
  351 00000318         
  352 00000318         
  353 00000318         Pisca_Transistor_PP5



ARM Macro Assembler    Page 11 


  354 00000318 F04F 0020       MOV              R0, #2_00100000
  355 0000031C B500            PUSH             {LR}
  356 0000031E F7FF FFFE       BL               PortP_Output ; chama a subrotin
                                                            a para ativar o tra
                                                            nsistor
  357 00000322 F44F 70FA       MOV              R0, #500
  358 00000326 F7FF FFFE       BL               SysTick_Wait1ms
  359 0000032A F04F 0000       MOV              R0, #2_00000000
  360 0000032E F7FF FFFE       BL               PortP_Output ; chama a subrotin
                                                            a para desativar o 
                                                            transistor
  361 00000332 F44F 70FA       MOV              R0, #500
  362 00000336 F7FF FFFE       BL               SysTick_Wait1ms
  363 0000033A F85D EB04       POP              {LR}
  364 0000033E 4770            BX               LR
  365 00000340         
  366 00000340         ; ------------------------------------------------------
                       --------------------------------------------------------
                       -----------
  367 00000340         ; Fim do Arquivo
  368 00000340         ; ------------------------------------------------------
                       --------------------------------------------------------
                       ----------- 
  369 00000340                 ALIGN                        ;Garante que o fim 
                                                            da se??o est? alinh
                                                            ada 
  370 00000340                 END                          ;Fim do arquivo
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
Command Line: --debug --xref --diag_suppress=9931,A1950W --cpu=Cortex-M4.fp.sp 
--depend=.\objects\main.d -o.\objects\main.o -IC:\Users\pedro\AppData\Local\Arm
\Packs\Keil\TM4C_DFP\1.1.0\Device\Include\TM4C129 --predefine="__EVAL SETA 1" -
-predefine="__UVISION_VERSION SETA 541" --predefine="TM4C1294NCPDT SETA 1" --li
st=.\listings\main.lst main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

DATA 00000000

Symbol: DATA
   Definitions
      At line 33 in file main.s
   Uses
      None
Comment: DATA unused
PASSWORDS 00000000

Symbol: PASSWORDS
   Definitions
      At line 40 in file main.s
   Uses
      At line 99 in file main.s
Comment: PASSWORDS used once
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 44 in file main.s
   Uses
      None
Comment: .text unused
CofreAbrindo 000001B0

Symbol: CofreAbrindo
   Definitions
      At line 197 in file main.s
   Uses
      At line 121 in file main.s
      At line 294 in file main.s

CofreFechado 0000018C

Symbol: CofreFechado
   Definitions
      At line 180 in file main.s
   Uses
      At line 119 in file main.s
Comment: CofreFechado used once
CofreFechando 00000164

Symbol: CofreFechando
   Definitions
      At line 166 in file main.s
   Uses
      At line 117 in file main.s
Comment: CofreFechando used once
CofreTravado 000001A0

Symbol: CofreTravado
   Definitions
      At line 189 in file main.s
   Uses
      At line 123 in file main.s
Comment: CofreTravado used once
ConferirSenha 00000270

Symbol: ConferirSenha
   Definitions
      At line 278 in file main.s
   Uses
      At line 276 in file main.s
      At line 289 in file main.s

ConferirSenhaMestra 000002AA

Symbol: ConferirSenhaMestra
   Definitions
      At line 305 in file main.s
   Uses
      At line 233 in file main.s
      At line 316 in file main.s




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

DestravaCofre 000001E0

Symbol: DestravaCofre
   Definitions
      At line 213 in file main.s
   Uses
      At line 50 in file main.s
      At line 125 in file main.s

DigitaSenhaMestra 000002D2

Symbol: DigitaSenhaMestra
   Definitions
      At line 324 in file main.s
   Uses
      At line 253 in file main.s
      At line 334 in file main.s

EstadoInicial 00000112

Symbol: EstadoInicial
   Definitions
      At line 131 in file main.s
   Uses
      At line 113 in file main.s
Comment: EstadoInicial used once
InserirSenha 00000146

Symbol: InserirSenha
   Definitions
      At line 151 in file main.s
   Uses
      At line 115 in file main.s
      At line 159 in file main.s
      At line 163 in file main.s

MainLoop 000000F2

Symbol: MainLoop
   Definitions
      At line 111 in file main.s
   Uses
      At line 129 in file main.s
      At line 149 in file main.s
      At line 164 in file main.s
      At line 178 in file main.s
      At line 195 in file main.s
      At line 211 in file main.s
      At line 303 in file main.s
      At line 322 in file main.s

ModificaSenhaMestra 0000020E

Symbol: ModificaSenhaMestra
   Definitions
      At line 235 in file main.s
   Uses
      At line 49 in file main.s
      At line 335 in file main.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols


PedeSenhaFechado 00000242

Symbol: PedeSenhaFechado
   Definitions
      At line 255 in file main.s
   Uses
      At line 187 in file main.s
      At line 299 in file main.s

Pisca_Transistor_PP5 00000318

Symbol: Pisca_Transistor_PP5
   Definitions
      At line 353 in file main.s
   Uses
      At line 51 in file main.s
Comment: Pisca_Transistor_PP5 used once
SenhaMestraAlterada 000002F2

Symbol: SenhaMestraAlterada
   Definitions
      At line 338 in file main.s
   Uses
      At line 336 in file main.s
Comment: SenhaMestraAlterada used once
SolicitaSenha 00000126

Symbol: SolicitaSenha
   Definitions
      At line 139 in file main.s
   Uses
      At line 137 in file main.s
      At line 160 in file main.s

Start 000000A6

Symbol: Start
   Definitions
      At line 87 in file main.s
   Uses
      At line 47 in file main.s
Comment: Start used once
cofre_aberto 00000000

Symbol: cofre_aberto
   Definitions
      At line 74 in file main.s
   Uses
      At line 133 in file main.s
Comment: cofre_aberto used once
cofre_abrindo 0000000D

Symbol: cofre_abrindo
   Definitions
      At line 75 in file main.s
   Uses
      At line 201 in file main.s
Comment: cofre_abrindo used once



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Relocatable symbols

cofre_fechado 00000051

Symbol: cofre_fechado
   Definitions
      At line 79 in file main.s
   Uses
      At line 182 in file main.s
Comment: cofre_fechado used once
cofre_fechando 00000040

Symbol: cofre_fechando
   Definitions
      At line 78 in file main.s
   Uses
      At line 170 in file main.s
Comment: cofre_fechando used once
cofre_travado 00000084

Symbol: cofre_travado
   Definitions
      At line 82 in file main.s
   Uses
      At line 191 in file main.s
Comment: cofre_travado used once
digite_senha 0000001E

Symbol: digite_senha
   Definitions
      At line 76 in file main.s
   Uses
      At line 142 in file main.s
      At line 258 in file main.s

digite_senha_mestra 00000095

Symbol: digite_senha_mestra
   Definitions
      At line 83 in file main.s
   Uses
      At line 216 in file main.s
Comment: digite_senha_mestra used once
reset_senha_mestra 00000062

Symbol: reset_senha_mestra
   Definitions
      At line 80 in file main.s
   Uses
      At line 240 in file main.s
Comment: reset_senha_mestra used once
senha_mestra_alterada 00000073

Symbol: senha_mestra_alterada
   Definitions
      At line 81 in file main.s
   Uses
      At line 342 in file main.s
Comment: senha_mestra_alterada used once
string_vazia 0000002F




ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Relocatable symbols

Symbol: string_vazia
   Definitions
      At line 77 in file main.s
   Uses
      At line 223 in file main.s
      At line 266 in file main.s

28 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

COFRE_ABRINDO 00000004

Symbol: COFRE_ABRINDO
   Definitions
      At line 24 in file main.s
   Uses
      At line 120 in file main.s
      At line 293 in file main.s
      At line 320 in file main.s

COFRE_FECHADO 00000003

Symbol: COFRE_FECHADO
   Definitions
      At line 23 in file main.s
   Uses
      At line 118 in file main.s
      At line 175 in file main.s

COFRE_FECHANDO 00000002

Symbol: COFRE_FECHANDO
   Definitions
      At line 22 in file main.s
   Uses
      At line 116 in file main.s
      At line 162 in file main.s

COFRE_TRAVADO 00000005

Symbol: COFRE_TRAVADO
   Definitions
      At line 25 in file main.s
   Uses
      At line 122 in file main.s
      At line 301 in file main.s

CONFIG_SENHA 00000001

Symbol: CONFIG_SENHA
   Definitions
      At line 21 in file main.s
   Uses
      At line 114 in file main.s
      At line 147 in file main.s

CONFIG_SENHA_MESTRA 00000007

Symbol: CONFIG_SENHA_MESTRA
   Definitions
      At line 27 in file main.s
   Uses
      At line 126 in file main.s
Comment: CONFIG_SENHA_MESTRA used once
DESTRAVA_COFRE 00000006

Symbol: DESTRAVA_COFRE
   Definitions
      At line 26 in file main.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Uses
      At line 124 in file main.s
      At line 321 in file main.s

INICIO 00000000

Symbol: INICIO
   Definitions
      At line 20 in file main.s
   Uses
      At line 96 in file main.s
      At line 112 in file main.s
      At line 206 in file main.s

INVALID_DIGIT 00000100

Symbol: INVALID_DIGIT
   Definitions
      At line 17 in file main.s
   Uses
      At line 94 in file main.s
      At line 153 in file main.s
      At line 156 in file main.s
      At line 228 in file main.s
      At line 274 in file main.s
      At line 285 in file main.s
      At line 312 in file main.s
      At line 328 in file main.s
      At line 331 in file main.s

INVALID_PW_CHAR FFFFFFFF

Symbol: INVALID_PW_CHAR
   Definitions
      At line 18 in file main.s
   Uses
      At line 286 in file main.s
      At line 313 in file main.s

10 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

GPIO_Init 00000000

Symbol: GPIO_Init
   Definitions
      At line 60 in file main.s
   Uses
      At line 90 in file main.s
Comment: GPIO_Init used once
LCD_Init 00000000

Symbol: LCD_Init
   Definitions
      At line 65 in file main.s
   Uses
      At line 93 in file main.s
Comment: LCD_Init used once
LCD_Line2 00000000

Symbol: LCD_Line2
   Definitions
      At line 66 in file main.s
   Uses
      At line 214 in file main.s
      At line 222 in file main.s
      At line 226 in file main.s
      At line 250 in file main.s
      At line 256 in file main.s
      At line 264 in file main.s
      At line 269 in file main.s

LCD_PrintString 00000000

Symbol: LCD_PrintString
   Definitions
      At line 68 in file main.s
   Uses
      At line 134 in file main.s
      At line 143 in file main.s
      At line 171 in file main.s
      At line 183 in file main.s
      At line 192 in file main.s
      At line 202 in file main.s
      At line 217 in file main.s
      At line 224 in file main.s
      At line 242 in file main.s
      At line 259 in file main.s
      At line 267 in file main.s
      At line 344 in file main.s

LCD_Reset 00000000

Symbol: LCD_Reset
   Definitions
      At line 67 in file main.s
   Uses
      At line 132 in file main.s
      At line 141 in file main.s
      At line 146 in file main.s
      At line 167 in file main.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols

      At line 174 in file main.s
      At line 181 in file main.s
      At line 190 in file main.s
      At line 198 in file main.s
      At line 205 in file main.s
      At line 238 in file main.s
      At line 340 in file main.s

LED_Output 00000000

Symbol: LED_Output
   Definitions
      At line 71 in file main.s
   Uses
      At line 193 in file main.s
Comment: LED_Output used once
MapMatrixKeyboard 00000000

Symbol: MapMatrixKeyboard
   Definitions
      At line 70 in file main.s
   Uses
      At line 152 in file main.s
      At line 279 in file main.s
      At line 306 in file main.s
      At line 326 in file main.s

PLL_Init 00000000

Symbol: PLL_Init
   Definitions
      At line 56 in file main.s
   Uses
      At line 88 in file main.s
Comment: PLL_Init used once
PortA_Output 00000000

Symbol: PortA_Output
   Definitions
      At line 61 in file main.s
   Uses
      None
Comment: PortA_Output unused
PortP_Output 00000000

Symbol: PortP_Output
   Definitions
      At line 62 in file main.s
   Uses
      At line 356 in file main.s
      At line 360 in file main.s

PortQ_Output 00000000

Symbol: PortQ_Output
   Definitions
      At line 63 in file main.s
   Uses
      None



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
External symbols

Comment: PortQ_Output unused
SysTick_Init 00000000

Symbol: SysTick_Init
   Definitions
      At line 57 in file main.s
   Uses
      At line 89 in file main.s
Comment: SysTick_Init used once
SysTick_Wait1ms 00000000

Symbol: SysTick_Wait1ms
   Definitions
      At line 58 in file main.s
   Uses
      At line 136 in file main.s
      At line 145 in file main.s
      At line 169 in file main.s
      At line 173 in file main.s
      At line 185 in file main.s
      At line 200 in file main.s
      At line 204 in file main.s
      At line 220 in file main.s
      At line 246 in file main.s
      At line 262 in file main.s
      At line 348 in file main.s
      At line 358 in file main.s
      At line 362 in file main.s

13 symbols
389 symbols in table
